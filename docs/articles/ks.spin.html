<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Computations for Lectures W7a-W8b - Practical Statistics I (2016/2017) • psistat</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Computations for Lectures W7a-W8b - Practical Statistics I (2016/2017)">
<meta property="og:description" content="psistat">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">psistat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.15-3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ks.spin.html">Computations for Lectures W7a-W8b - Practical Statistics I (2016/2017)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Computations for Lectures W7a-W8b - Practical Statistics I (2016/2017)</h1>
            <h3 class="subtitle">Edited examples from the lectures</h3>
                        <h4 class="author">Georgi N. Boshnakov</h4>
            
            <h4 class="date">March 2017</h4>
      
      
      <div class="hidden name"><code>ks.spin.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Supplementary materials}
-->
<div id="packages-and-functions-for-topic-goodness-of-fit" class="section level2">
<h2 class="hasAnchor">
<a href="#packages-and-functions-for-topic-goodness-of-fit" class="anchor"></a>Packages and functions for topic “goodness of fit”</h2>
<div id="functions-in-base-r" class="section level3">
<h3 class="hasAnchor">
<a href="#functions-in-base-r" class="anchor"></a>Functions in base R</h3>
<div class="sourceCode" id="cb1"><html><body><pre class="r">?<span class="no">ks.test</span>
?<span class="no">ecdf</span>
?<span class="no">qqnorm</span>
?<span class="no">qqline</span></pre></body></html></div>
</div>
<div id="package-psistat" class="section level3">
<h3 class="hasAnchor">
<a href="#package-psistat" class="anchor"></a>Package “psistat”</h3>
<p>Package psistat provides some useful functions for this topic. You can install it on your own computers from the web page of the course (if you have not done this yet).</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">psistat</span>)</pre></body></html></div>
<p>The names of the functions in “psistat” start with “psi.”. You can learn more about them using the help system. For example:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/apropos.html">apropos</a></span>(<span class="st">"psi.*"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/help.html">help</a></span>(<span class="kw">package</span><span class="kw">=</span><span class="st">"psistat"</span>)
<span class="no">package</span> ? <span class="no">psistat</span>
?<span class="no">psi.eqf</span>
?<span class="no">psi.Dn</span>
?<span class="no">psi.lks.exp.test</span>
?<span class="no">psi.jitter</span></pre></body></html></div>
</div>
<div id="other-libraries-providing-relevant-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#other-libraries-providing-relevant-functions" class="anchor"></a>Other libraries providing relevant functions:</h3>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">nortest</span>) <span class="co"># for Lilliefors test</span>
?<span class="no">lillie.test</span></pre></body></html></div>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">e1071</span>)  <span class="co"># for probplot</span>
?<span class="no">probplot</span></pre></body></html></div>
<p>Dataset Oxboys is in package “mlmRev”</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mlmRev</span>)
<span class="co"># ?Oxboys</span></pre></body></html></div>
<p>Miscellaneous: use this command to plot in a new window:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.new</a></span>()</pre></body></html></div>
<p>Some random samples for the following examples.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">x20</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">20</span>)            <span class="co"># a short random sample, to show it on screen</span>
<span class="no">x200</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">200</span>)          <span class="co"># larger</span>
<span class="no">x500</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">500</span>)          <span class="co"># even larger</span>
<span class="no">x500ms</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">500</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">3</span>)

<span class="no">x2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">rchisq</a></span>(<span class="fl">100</span>, <span class="kw">df</span> <span class="kw">=</span> <span class="fl">2</span>)

<span class="no">xe</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span>(<span class="fl">500</span>, <span class="kw">rate</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">1500</span>) <span class="co"># life times of electric bulbs</span></pre></body></html></div>
</div>
</div>
<div id="empirical-cdf-ecdf" class="section level2">
<h2 class="hasAnchor">
<a href="#empirical-cdf-ecdf" class="anchor"></a>Empirical cdf (ecdf)</h2>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">x20.ecdf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html">ecdf</a></span>(<span class="no">x20</span>)              <span class="co"># its ecdf</span>
<span class="no">x20.ecdf</span></pre></body></html></div>
<pre><code>## Empirical CDF 
## Call: ecdf(x20)
##  x[1:20] = -2.3457, -1.2071, -0.99839,  ..., 1.0844, 2.4158</code></pre>
<p>x20.ecdf is a function - we can use it as any other R function:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu">x20.ecdf</span>(<span class="fl">0</span>)</pre></body></html></div>
<pre><code>## [1] 0.65</code></pre>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu">x20.ecdf</span>(<span class="fl">10</span>)</pre></body></html></div>
<pre><code>## [1] 1</code></pre>
<p>Here we plot the ecdf and overlay the cdf used to simulate the data. The sample is small, so the two do not match very closely:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x20.ecdf</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="no">pnorm</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>At the places were the ecdf jumps, the value is the one after the jump (indicated by the filled points). Here is a histogram with overlayed pdf for comparison.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">x20</span>, <span class="kw">freq</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.5</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="no">dnorm</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>For larger samples the ecdf is very good estimator of the underlying cdf:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">x200.ecdf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html">ecdf</a></span>(<span class="no">x200</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x200.ecdf</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="no">pnorm</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>… and an even larger sample:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">x500.ecdf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html">ecdf</a></span>(<span class="no">x500</span>)            <span class="co"># its ecdf</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x500.ecdf</span>)                    <span class="co"># ecdf and cdf overlayed</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="no">pnorm</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>)
<span class="co">## This shows how to add the curve with non-default values of the</span>
<span class="co">## arguments. This simply illustrates the technique:</span>
<span class="no">norm2</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="no">x</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="no">norm2</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div id="empirical-quantiles" class="section level2">
<h2 class="hasAnchor">
<a href="#empirical-quantiles" class="anchor"></a>Empirical quantiles</h2>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="co"># ?quantile</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x500</span>, <span class="kw">probs</span><span class="kw">=</span><span class="fl">0.5</span>)</pre></body></html></div>
<pre><code>##          50% 
## -0.005702427</code></pre>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x500</span>, <span class="kw">probs</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>, <span class="fl">0.75</span>))</pre></body></html></div>
<pre><code>##          25%          50%          75% 
## -0.700895608 -0.005702427  0.604292246</code></pre>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x20</span>, <span class="fl">0.5</span>)</pre></body></html></div>
<pre><code>##        50% 
## -0.5288207</code></pre>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">x20</span>, <span class="kw">freq</span><span class="kw">=</span><span class="fl">FALSE</span>, <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.5</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="no">dnorm</span>, <span class="kw">from</span> <span class="kw">=</span> -<span class="fl">3</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">3</span>,  <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div id="examples-with-psi-eqf" class="section level3">
<h3 class="hasAnchor">
<a href="#examples-with-psi-eqf" class="anchor"></a>Examples with psi.eqf</h3>
<p>Empirical quantile function (from package “psistat”)</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r">?<span class="no">psi.eqf</span></pre></body></html></div>
<p>The eqf of a small sample:</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">x20.eqf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/psi.eqf.html">psi.eqf</a></span>(<span class="no">x20</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x20.eqf</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Eqf of x20"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="no">qnorm</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
<pre><code>## Warning in qnorm(x): NaNs produced</code></pre>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="co"># plot(x200)</span>
<span class="no">x200ecdf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html">ecdf</a></span>(<span class="no">x200</span>)
<span class="fu">x200ecdf</span>(<span class="fl">0</span>)</pre></body></html></div>
<pre><code>## [1] 0.54</code></pre>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x200</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.25</span>, <span class="fl">.5</span>, <span class="fl">0.75</span>))</pre></body></html></div>
<pre><code>##         25%         50%         75% 
## -0.65421071 -0.08424212  0.62585887</code></pre>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">x200eqf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/psi.eqf.html">psi.eqf</a></span>(<span class="no">x200</span>)
<span class="fu">x200eqf</span>(<span class="fl">0.5</span>)</pre></body></html></div>
<pre><code>## [1] -0.09979059</code></pre>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="fu">x200eqf</span>(<span class="fl">0.25</span>)</pre></body></html></div>
<pre><code>## [1] -0.6696336</code></pre>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x200eqf</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Eqf of x200"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-19-2.png" width="700"></p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">x500.eqf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/psi.eqf.html">psi.eqf</a></span>(<span class="no">x500</span>)          <span class="co"># a larger sample</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x500.eqf</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Eqf of x500"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="no">qnorm</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
<pre><code>## Warning in qnorm(x): NaNs produced</code></pre>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-19-3.png" width="700"></p>
</div>
</div>
<div id="qq-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#qq-plots" class="anchor"></a>QQ-plots</h2>
<div id="diy-qq-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#diy-qq-plots" class="anchor"></a>DIY qq-plots</h3>
<p>We follow the procedure given in the notes: prepare points p, evaluate the scores s, compute the order statistics and plot. Does x20 come from N(0,1)?</p>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="no">n</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x20</span>)
<span class="no">n</span></pre></body></html></div>
<pre><code>## [1] 20</code></pre>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="no">p</span> <span class="kw">&lt;-</span> (<span class="fl">1</span>:<span class="no">n</span> - <span class="fl">0.5</span>)   <span class="co"># to check that it gives 0.5, 1.5, ..., 19.5</span>
<span class="no">p</span></pre></body></html></div>
<pre><code>##  [1]  0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5 10.5 11.5 12.5 13.5 14.5
## [16] 15.5 16.5 17.5 18.5 19.5</code></pre>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="no">p</span> <span class="kw">&lt;-</span> (<span class="fl">1</span>:<span class="no">n</span> - <span class="fl">0.5</span>)/<span class="no">n</span>
<span class="no">p</span></pre></body></html></div>
<pre><code>##  [1] 0.025 0.075 0.125 0.175 0.225 0.275 0.325 0.375 0.425 0.475 0.525 0.575
## [13] 0.625 0.675 0.725 0.775 0.825 0.875 0.925 0.975</code></pre>
<div class="sourceCode" id="cb46"><html><body><pre class="r"><span class="no">s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="no">p</span>)            <span class="co"># scores</span>
<span class="no">x20.sorted</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="no">x20</span>)  <span class="co"># order statistics</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">s</span>, <span class="no">x20.sorted</span>)      <span class="co"># qq-plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>) <span class="co"># plot the reference line</span></pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>Does x2 come from N(0,1)?</p>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="no">n</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x2</span>)
<span class="no">p</span> <span class="kw">&lt;-</span> ((<span class="fl">1</span>:<span class="no">n</span>) - <span class="fl">0.5</span>) / <span class="no">n</span>
<span class="no">s2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="no">p</span>)
<span class="no">x2s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="no">x2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">s2</span>, <span class="no">x2s</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>Does x200 come from N(0,1)?</p>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="no">n</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x200</span>)
<span class="no">p</span> <span class="kw">&lt;-</span> ((<span class="fl">1</span>:<span class="no">n</span>) - <span class="fl">0.5</span>) / <span class="no">n</span>
<span class="no">si</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="no">p</span>)
<span class="no">x200.sorted</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="no">x200</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">si</span>, <span class="no">x200.sorted</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>Does x200 come from Student-t with 3 d.f.?</p>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="no">si</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span>(<span class="no">p</span>, <span class="kw">df</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">si</span>, <span class="no">x200.sorted</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>,<span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>Does x500 come from N(0,1)?</p>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="no">n</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x500</span>)                  <span class="co"># x500</span>
<span class="no">p</span> <span class="kw">&lt;-</span> (<span class="fl">1</span>:<span class="no">n</span> - <span class="fl">0.5</span>)/<span class="no">n</span>
<span class="no">s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="no">p</span>)
<span class="no">x500.sorted</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="no">x500</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">s</span>, <span class="no">x500.sorted</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>,<span class="fl">1</span>)                        <span class="co"># various ways to overlay a line</span>
<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">x500.sorted</span> ~ <span class="no">s</span>)</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = x500.sorted ~ s)
## 
## Coefficients:
## (Intercept)            s  
##    -0.03162      1.00690</code></pre>
<div class="sourceCode" id="cb52"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">x500.sorted</span> ~ <span class="no">s</span>), <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span>(<span class="no">x500.sorted</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>qq-plots for x500 The following examples are of qq-plots for x500 with various non-matching distributions.</p>
<div class="sourceCode" id="cb53"><html><body><pre class="r"><span class="no">s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span>(<span class="no">p</span>, <span class="kw">df</span> <span class="kw">=</span> <span class="fl">3</span>)      <span class="co"># H0 is t_3 dist</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">s</span>, <span class="no">x500.sorted</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"blue"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<div class="sourceCode" id="cb54"><html><body><pre class="r"><span class="no">s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="no">p</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">5</span>) <span class="co"># H0 is N(5,1)</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">s</span>,<span class="no">x500.sorted</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-26-2.png" width="700"></p>
<div class="sourceCode" id="cb55"><html><body><pre class="r"><span class="no">s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="no">p</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">2</span>) <span class="co"># H0 is N(5,2^2)</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">s</span>, <span class="no">x500.sorted</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-26-3.png" width="700"></p>
<div class="sourceCode" id="cb56"><html><body><pre class="r"><span class="no">x500ms.sorted</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="no">x500ms</span>)
<span class="no">p</span> <span class="kw">&lt;-</span> ((<span class="fl">1</span>:<span class="fl">500</span>) - <span class="fl">0.5</span>)/<span class="fl">500</span>
<span class="no">s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="no">p</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">s</span>, <span class="no">x500ms.sorted</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)

<span class="no">lmfit500</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">x500ms.sorted</span> ~ <span class="no">s</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">lmfit500</span>)</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = x500ms.sorted ~ s)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.34243 -0.04548  0.02041  0.07568  0.24411 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.958476   0.006293   152.3   &lt;2e-16 ***
## s           2.889440   0.006301   458.6   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.1407 on 498 degrees of freedom
## Multiple R-squared:  0.9976, Adjusted R-squared:  0.9976 
## F-statistic: 2.103e+05 on 1 and 498 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb58"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="no">lmfit500</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-26-4.png" width="700"></p>
<p>qq-plot example with an exponential distribution. First generate some data to work with: xe might represent lifetime of bulbs (incandescent have typical expected life equal to 1500 hours).</p>
<div class="sourceCode" id="cb59"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">xe</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<div class="sourceCode" id="cb60"><html><body><pre class="r"><span class="no">n</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">xe</span>)
<span class="no">p</span> <span class="kw">&lt;-</span> ((<span class="fl">1</span>:<span class="no">n</span>) - <span class="fl">0.5</span>) / <span class="no">n</span>
<span class="no">s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">qexp</a></span>(<span class="no">p</span>, <span class="kw">rate</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">1500</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">s</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="no">xe</span>))</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-27-2.png" width="700"></p>
</div>
<div id="non-diy-qq-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#non-diy-qq-plots" class="anchor"></a>Non-diy qq-plots</h3>
<p>qqnorm produces a normal qq-plot, i.e. a qq-plot for hypothesised normal distribution:</p>
<div class="sourceCode" id="cb61"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span>(<span class="no">x500ms</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>,<span class="fl">1</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<div class="sourceCode" id="cb62"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span>(<span class="no">x500</span>)                   <span class="co"># qqnorm</span></pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-28-2.png" width="700"></p>
<div class="sourceCode" id="cb63"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span>(<span class="no">xe</span>)     <span class="co"># no match here</span></pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-28-3.png" width="700"></p>
<p>probplot() is another function for qq-plots. Without further arguments it produces a normal plot:</p>
<div class="sourceCode" id="cb64"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">e1071</span>, <span class="kw">quiet</span> <span class="kw">=</span> <span class="fl">TRUE</span>)  <span class="co"># for probplot</span>
<span class="fu"><a href="https://rdrr.io/pkg/e1071/man/probplot.html">probplot</a></span>(<span class="no">x500</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<p>For other hypothesised distributions the relevant quantile function should be given. We often need to define the function ourselves.</p>
<div class="sourceCode" id="cb65"><html><body><pre class="r">#
# this doesn't work since probplot insists on naming the argument 'p'
# qexp1500 &lt;- function(x) qexp(x, rate=1/1500)
#
                                        # here we oblige.</pre></body></html></div>
<p>This function computes quantiles for exponential distribution with mean 1500:</p>
<div class="sourceCode" id="cb66"><html><body><pre class="r"><span class="no">qexp1500</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">p</span>) <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">qexp</a></span>(<span class="no">p</span>, <span class="kw">rate</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">1500</span>)</pre></body></html></div>
<p>(Note that probplot insists that the first argument is called ‘p’.) Compare:</p>
<div class="sourceCode" id="cb67"><html><body><pre class="r"><span class="fu">qexp1500</span>(<span class="fl">0.5</span>)</pre></body></html></div>
<pre><code>## [1] 1039.721</code></pre>
<div class="sourceCode" id="cb69"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">qexp</a></span>(<span class="fl">0.5</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">1</span>/<span class="fl">1500</span>)</pre></body></html></div>
<pre><code>## [1] 1039.721</code></pre>
<p>Create the plot:</p>
<div class="sourceCode" id="cb71"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/probplot.html">probplot</a></span>(<span class="no">xe</span>, <span class="no">qexp1500</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<div class="sourceCode" id="cb72"><html><body><pre class="r"><span class="no">x2a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">500</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">5</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span>(<span class="no">x2a</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-33-2.png" width="700"></p>
<div class="sourceCode" id="cb73"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">x2a</span>)</pre></body></html></div>
<pre><code>## [1] 5.11848</code></pre>
<div class="sourceCode" id="cb75"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">x2a</span>)</pre></body></html></div>
<pre><code>## [1] 2.120752</code></pre>
<p>example: bulbs.txt</p>
<div class="sourceCode" id="cb77"><html><body><pre class="r"><span class="no">bulbs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span>(<span class="st">"bulbs.txt"</span>)
<span class="no">bulbs</span></pre></body></html></div>
<pre><code>##  [1] 1615.3880 1751.3540  951.2327 3727.3430 1333.2010  914.8320  507.4933
##  [8]  213.3106  862.1596 2217.3740</code></pre>
<div class="sourceCode" id="cb79"><html><body><pre class="r"><span class="no">qexp1500</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">p</span>){ <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">qexp</a></span>(<span class="no">p</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">1</span>/<span class="fl">1500</span>) }
<span class="fu"><a href="https://rdrr.io/pkg/e1071/man/probplot.html">probplot</a></span>(<span class="no">bulbs</span>, <span class="kw">qdist</span> <span class="kw">=</span> <span class="no">qexp1500</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
<div class="sourceCode" id="cb80"><html><body><pre class="r"><span class="no">e100</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span>(<span class="fl">100</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">1</span>/<span class="fl">1500</span>)
<span class="no">p</span> <span class="kw">&lt;-</span> ((<span class="fl">1</span>:<span class="fl">100</span>) - <span class="fl">0.5</span>)/<span class="fl">100</span>
<span class="no">s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">qexp</a></span>(<span class="no">p</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">1</span>/<span class="fl">1500</span>)
<span class="no">e100s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="no">e100</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">s</span>, <span class="no">e100s</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>,<span class="fl">1</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-34-2.png" width="700"></p>
<div class="sourceCode" id="cb81"><html><body><pre class="r"><span class="no">e1000</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span>(<span class="fl">1000</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">1</span>/<span class="fl">1500</span>)
<span class="no">p</span> <span class="kw">&lt;-</span> ((<span class="fl">1</span>:<span class="fl">1000</span>) - <span class="fl">0.5</span>)/<span class="fl">1000</span>
<span class="no">s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">qexp</a></span>(<span class="no">p</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">1</span>/<span class="fl">1500</span>)
<span class="no">e1000s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="no">e1000</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">s</span>, <span class="no">e1000s</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>,<span class="fl">1</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-34-3.png" width="700"></p>
<div class="sourceCode" id="cb82"><html><body><pre class="r"><span class="no">s</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="no">p</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">s</span>, <span class="no">e1000s</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-34-4.png" width="700"></p>
<div class="sourceCode" id="cb83"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">e1071</span>)
<span class="fu"><a href="https://rdrr.io/pkg/e1071/man/probplot.html">probplot</a></span>(<span class="no">e1000</span>, <span class="no">qexp</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-34-5.png" width="700"></p>
<div class="sourceCode" id="cb84"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/probplot.html">probplot</a></span>(<span class="no">e1000</span>, <span class="no">qnorm</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-34-6.png" width="700"></p>
<div class="sourceCode" id="cb85"><html><body><pre class="r"><span class="co"># ?qexp</span>

<span class="no">qchisq5</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">p</span>) <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq</a></span>(<span class="no">p</span>, <span class="kw">df</span><span class="kw">=</span><span class="fl">5</span>)
<span class="fu"><a href="https://rdrr.io/pkg/e1071/man/probplot.html">probplot</a></span>(<span class="no">e1000</span>,<span class="no">qchisq5</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-34-7.png" width="700"></p>
</div>
</div>
<div id="distributions-of-order-statistics" class="section level2">
<h2 class="hasAnchor">
<a href="#distributions-of-order-statistics" class="anchor"></a>Distributions of order statistics</h2>
<p>Approx mean and variance of order statistics example in Notes, p. 69</p>
<p>first using formulae on pp. 68-69</p>
<div class="sourceCode" id="cb86"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="fl">4</span>/(<span class="fl">19</span>+<span class="fl">1</span>))</pre></body></html></div>
<pre><code>## [1] -0.8416212</code></pre>
<div class="sourceCode" id="cb88"><html><body><pre class="r"><span class="no">ex</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="fl">4</span>/(<span class="fl">19</span>+<span class="fl">1</span>))
<span class="no">ex</span></pre></body></html></div>
<pre><code>## [1] -0.8416212</code></pre>
<div class="sourceCode" id="cb90"><html><body><pre class="r"><span class="no">exvar</span> <span class="kw">&lt;-</span> <span class="fl">4</span>*(<span class="fl">19</span>-<span class="fl">4</span>+<span class="fl">1</span>)/((<span class="fl">19</span>+<span class="fl">1</span>)^<span class="fl">2</span>*(<span class="fl">19</span>+<span class="fl">2</span>))/<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(<span class="no">ex</span>)^<span class="fl">2</span>
<span class="no">exvar</span></pre></body></html></div>
<pre><code>## [1] 0.09720817</code></pre>
<p>… then via simulation</p>
<div class="sourceCode" id="cb92"><html><body><pre class="r"><span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span>(<span class="fl">1000</span>)
<span class="no">y</span>[<span class="fl">1</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">19</span>))[<span class="fl">4</span>]
<span class="no">y</span>[<span class="fl">2</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">19</span>))[<span class="fl">4</span>]</pre></body></html></div>
<p>and so on until y[1000] … :)</p>
<div class="sourceCode" id="cb93"><html><body><pre class="r"><span class="co"># ... but better use a single command</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">1000</span>) <span class="no">y</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">19</span>))[<span class="fl">4</span>]

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">y</span>, <span class="kw">freq</span><span class="kw">=</span><span class="fl">FALSE</span>)  <span class="co"># estimate density</span></pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<div class="sourceCode" id="cb94"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">y</span>)              <span class="co"># estimate mean</span></pre></body></html></div>
<pre><code>## [1] -0.8928535</code></pre>
<div class="sourceCode" id="cb96"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span>(<span class="no">y</span>)               <span class="co"># estimate variance</span></pre></body></html></div>
<pre><code>## [1] 0.1049445</code></pre>
<p>this is an alternative to the ‘for’ loop (explain “replicate”)</p>
<div class="sourceCode" id="cb98"><html><body><pre class="r"><span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="fl">1000</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">19</span>))[<span class="fl">4</span>])
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">y</span>)</pre></body></html></div>
<pre><code>## [1] -0.8994723</code></pre>
<div class="sourceCode" id="cb100"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span>(<span class="no">y</span>)</pre></body></html></div>
<pre><code>## [1] 0.1124937</code></pre>
<div class="sourceCode" id="cb102"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>))</pre></body></html></div>
<pre><code>##        25%        50%        75% 
## -1.1191086 -0.8994697 -0.6677008</code></pre>
<div class="sourceCode" id="cb104"><html><body><pre class="r"><span class="no">N</span> <span class="kw">&lt;-</span> <span class="fl">1000</span>
<span class="no">x4</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span>(<span class="no">N</span>)
<span class="no">x4</span>[<span class="fl">1</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">19</span>))[<span class="fl">4</span>]
<span class="no">x4</span>[<span class="fl">1</span>]</pre></body></html></div>
<pre><code>## [1] -0.6385599</code></pre>
<div class="sourceCode" id="cb106"><html><body><pre class="r"><span class="no">x4</span>[<span class="fl">2</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">19</span>))[<span class="fl">4</span>]
<span class="co"># ... and so on; let's do it with a single command:</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">N</span>) <span class="no">x4</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">19</span>))[<span class="fl">4</span>]</pre></body></html></div>
<p>Explore the distribution of the fourth order statistic:</p>
<div class="sourceCode" id="cb107"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">x4</span>)</pre></body></html></div>
<pre><code>## [1] -0.8927811</code></pre>
<div class="sourceCode" id="cb109"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span>(<span class="no">x4</span>)</pre></body></html></div>
<pre><code>## [1] 0.1052386</code></pre>
<div class="sourceCode" id="cb111"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">x4</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
<div class="sourceCode" id="cb112"><html><body><pre class="r"><span class="no">x4ecdf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html">ecdf</a></span>(<span class="no">x4</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="no">x4ecdf</span>, <span class="kw">from</span> <span class="kw">=</span> -<span class="fl">2</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-39-2.png" width="700"></p>
<div class="sourceCode" id="cb113"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x4ecdf</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="no">pnorm</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-39-3.png" width="700"></p>
</div>
<div id="inverse-pit" class="section level2">
<h2 class="hasAnchor">
<a href="#inverse-pit" class="anchor"></a>Inverse PIT</h2>
<p>DIY generation of a random sample from distribution Expo(1/2) First generate a sample from the uniform distribution.</p>
<div class="sourceCode" id="cb114"><html><body><pre class="r"><span class="no">u</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">8</span>)
<span class="no">u</span></pre></body></html></div>
<pre><code>## [1] 0.96726824 0.39173353 0.93379904 0.76794545 0.32535914 0.57392644 0.06652616
## [8] 0.87910583</code></pre>
<p>Evaluate the quantiles of the required distribution (Expo(1/2) here) for the values in the U(0,1) random sample:</p>
<div class="sourceCode" id="cb116"><html><body><pre class="r"><span class="no">y</span> <span class="kw">&lt;-</span> -<span class="fl">2</span>*<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">1</span>-<span class="no">u</span>)     <span class="co">#  DIY quantile function of Expo(1/2)</span>
<span class="no">y</span></pre></body></html></div>
<pre><code>## [1] 6.8388189 0.9942844 5.4301207 2.9215656 0.7871496 1.7062866 0.1376847
## [8] 4.2256796</code></pre>
<div class="sourceCode" id="cb118"><html><body><pre class="r"><span class="no">y1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">qexp</a></span>(<span class="no">u</span>, <span class="kw">rate</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">2</span>) <span class="co"># built-in quantile function</span>
<span class="no">y1</span></pre></body></html></div>
<pre><code>## [1] 6.8388189 0.9942844 5.4301207 2.9215656 0.7871496 1.7062866 0.1376847
## [8] 4.2256796</code></pre>
<p>The results are the same (so, qexp uses the formula -log(1-u)/lambda):</p>
<div class="sourceCode" id="cb120"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span>(<span class="no">y</span> <span class="kw">==</span> <span class="no">y1</span>)</pre></body></html></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="kolmogorov-smirnov-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#kolmogorov-smirnov-tests" class="anchor"></a>Kolmogorov-Smirnov tests</h2>
<div class="sourceCode" id="cb122"><html><body><pre class="r"><span class="no">u</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">100</span>)
<span class="no">x</span> <span class="kw">&lt;-</span> -<span class="fl">1</span>/<span class="fl">2</span>*<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">1</span>-<span class="no">u</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">x</span>, <span class="st">"pexp"</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">2</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  x
## D = 0.087857, p-value = 0.423
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb124"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">x</span>, <span class="st">"pexp"</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">10</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  x
## D = 0.56113, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb126"><html><body><pre class="r"><span class="no">pexp2</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">pexp</a></span>(<span class="no">x</span>, <span class="kw">rate</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">x</span>, <span class="no">pexp2</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  x
## D = 0.087857, p-value = 0.423
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb128"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.Dn.html">psi.Dn</a></span>(<span class="no">x</span>, <span class="no">pexp2</span>)</pre></body></html></div>
<pre><code>## [1] 0.08785689</code></pre>
<div class="sourceCode" id="cb130"><html><body><pre class="r"><span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">10</span>)
<span class="no">x</span></pre></body></html></div>
<pre><code>##  [1] 0.60772038 0.71454058 0.31063085 0.40909066 0.05476674 0.87197316
##  [7] 0.80187151 0.04541741 0.35022657 0.16252157</code></pre>
<div class="sourceCode" id="cb132"><html><body><pre class="r"><span class="no">y</span> <span class="kw">&lt;-</span> -<span class="fl">1</span>/<span class="fl">2</span>*<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">1</span>-<span class="no">x</span>)
<span class="no">y</span></pre></body></html></div>
<pre><code>##  [1] 0.46789019 0.62682769 0.18598919 0.26304634 0.02816177 1.02775768
##  [7] 0.80941975 0.02324056 0.21556577 0.08867989</code></pre>
<div class="sourceCode" id="cb134"><html><body><pre class="r"><span class="no">y1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">qexp</a></span>(<span class="no">x</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">2</span>)
<span class="no">y1</span></pre></body></html></div>
<pre><code>##  [1] 0.46789019 0.62682769 0.18598919 0.26304634 0.02816177 1.02775768
##  [7] 0.80941975 0.02324056 0.21556577 0.08867989</code></pre>
<div class="sourceCode" id="cb136"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span>(<span class="no">y</span><span class="kw">==</span><span class="no">y1</span>)  <span class="co"># TRUE (so, qexp uses the above formula</span></pre></body></html></div>
<pre><code>## [1] TRUE</code></pre>
<p>The cdf of the test statistic in KS test See examples for psi.pks.</p>
<div class="sourceCode" id="cb138"><html><body><pre class="r"><span class="co"># ?psi.pks</span>
<span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="fl">0.6239385</span>,<span class="fl">4</span>)</pre></body></html></div>
<pre><code>## [1] 0.95</code></pre>
<div class="sourceCode" id="cb140"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="fl">0.2940753</span>,<span class="fl">20</span>)</pre></body></html></div>
<pre><code>## [1] 0.95</code></pre>
<div class="sourceCode" id="cb142"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="fl">0.1340279</span>,<span class="fl">100</span>)</pre></body></html></div>
<pre><code>## [1] 0.95</code></pre>
<div class="sourceCode" id="cb144"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="fl">0.04294685</span>,<span class="fl">1000</span>)</pre></body></html></div>
<pre><code>## [1] 0.95</code></pre>
<p>Compare the distribution of the test statistic for various sample sizes:</p>
<div class="sourceCode" id="cb146"><html><body><pre class="r"><span class="no">xi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>,<span class="fl">1</span>,<span class="kw">length</span><span class="kw">=</span><span class="fl">100</span>)            <span class="co"># some x values</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">xi</span>,<span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">xi</span>,<span class="fl">4</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">xi</span>,<span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">xi</span>,<span class="fl">4</span>))              <span class="co"># cdf of D_4</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">xi</span>,<span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">xi</span>,<span class="fl">50</span>),<span class="kw">col</span><span class="kw">=</span><span class="st">"blue"</span>)  <span class="co"># overlay the cdf of  D_{50}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">xi</span>,<span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">xi</span>,<span class="fl">100</span>),<span class="kw">col</span><span class="kw">=</span><span class="st">"red"</span>)  <span class="co"># overlay the cdf of  D_{100}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">h</span><span class="kw">=</span><span class="fl">0.95</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"brown"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">xi</span>,<span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">xi</span>,<span class="fl">1000</span>),<span class="kw">col</span><span class="kw">=</span><span class="st">"green"</span>)  <span class="co"># overlay the cdf of  D_{1000}</span></pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-45-1.png" width="700"></p>
<p>The abscissa of the intersection of the brown line with each of the curves gives the corresponding critical value of the KS test. Notice that for larger samples the critical value is smaller. In other words, smaller deviations from the hypothesised distribution function are considered significant. Similar to above using curve():</p>
<div class="sourceCode" id="cb147"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">x</span>,<span class="fl">4</span>), <span class="kw">from</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">to</span><span class="kw">=</span><span class="fl">1</span>)                             <span class="co"># cdf of D_4</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">x</span>,<span class="fl">10</span>), <span class="kw">from</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">to</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"blue"</span>, <span class="kw">add</span><span class="kw">=</span><span class="fl">TRUE</span>)      <span class="co"># cdf of D_10</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">x</span>,<span class="fl">50</span>), <span class="kw">from</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">to</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"brown"</span>, <span class="kw">add</span><span class="kw">=</span><span class="fl">TRUE</span>)     <span class="co"># cdf of D_50</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">x</span>,<span class="fl">100</span>), <span class="kw">from</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">to</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"red"</span>, <span class="kw">add</span><span class="kw">=</span><span class="fl">TRUE</span>)      <span class="co"># cdf of D_100</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">x</span>,<span class="fl">1000</span>), <span class="kw">from</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">to</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"green"</span>, <span class="kw">add</span><span class="kw">=</span><span class="fl">TRUE</span>)   <span class="co"># cdf of D_1000</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">h</span><span class="kw">=</span><span class="fl">0.95</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"brown"</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-46-1.png" width="700"></p>
<div id="diy-dn" class="section level3">
<h3 class="hasAnchor">
<a href="#diy-dn" class="anchor"></a>DIY Dn</h3>
<div class="sourceCode" id="cb148"><html><body><pre class="r"><span class="no">x10</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">10</span>)</pre></body></html></div>
<p>diy Dn for H_0 = cdf of N(0,1)</p>
<div class="sourceCode" id="cb149"><html><body><pre class="r"><span class="no">u10</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="no">x10</span>)
<span class="no">u10</span></pre></body></html></div>
<pre><code>##  [1] 0.50005467 0.94167283 0.57367674 0.25966462 0.79541192 0.95330771
##  [7] 0.33814719 0.06689247 0.81922995 0.23913859</code></pre>
<div class="sourceCode" id="cb151"><html><body><pre class="r"><span class="no">u10</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="no">x10</span>))
<span class="no">u10</span></pre></body></html></div>
<pre><code>##  [1] 0.06689247 0.23913859 0.25966462 0.33814719 0.50005467 0.57367674
##  [7] 0.79541192 0.81922995 0.94167283 0.95330771</code></pre>
<div class="sourceCode" id="cb153"><html><body><pre class="r"><span class="no">n</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="no">x10Dn</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>((<span class="fl">1</span>:<span class="no">n</span>)/<span class="no">n</span> - <span class="no">u10</span>, <span class="no">u10</span> - (<span class="fl">0</span>:(<span class="no">n</span>-<span class="fl">1</span>)/<span class="no">n</span>))
<span class="no">x10Dn</span></pre></body></html></div>
<pre><code>## [1] 0.1954119</code></pre>
<p>now use psi.Dn to compute Dn, should give the same result.</p>
<div class="sourceCode" id="cb155"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.Dn.html">psi.Dn</a></span>(<span class="no">x10</span>)</pre></body></html></div>
<pre><code>## [1] 0.1954119</code></pre>
<div class="sourceCode" id="cb157"><html><body><pre class="r"><span class="co"># KS test</span>
<span class="co">#</span>
<span class="co"># ?psi.Dn</span>
<span class="no">x</span></pre></body></html></div>
<pre><code>##  [1] 0.60772038 0.71454058 0.31063085 0.40909066 0.05476674 0.87197316
##  [7] 0.80187151 0.04541741 0.35022657 0.16252157</code></pre>
<div class="sourceCode" id="cb159"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.Dn.html">psi.Dn</a></span>(<span class="no">x</span>)</pre></body></html></div>
<pre><code>## [1] 0.5181127</code></pre>
<p>The value of the statistic is the same as that from ks.test:</p>
<div class="sourceCode" id="cb161"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">x</span>, <span class="no">pnorm</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  x
## D = 0.51811, p-value = 0.005074
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb163"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.Dn.html">psi.Dn</a></span>(<span class="no">x</span>) <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">x</span>, <span class="no">pnorm</span>)$<span class="no">statistic</span></pre></body></html></div>
<pre><code>##    D 
## TRUE</code></pre>
<div class="sourceCode" id="cb165"><html><body><pre class="r"><span class="no">pe</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">pexp</a></span>(<span class="no">x</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">1</span>/<span class="fl">1500</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">x</span>, <span class="no">pe</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  x
## D = 0.99942, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<p>KS test 2013/2014 chunk</p>
<div class="sourceCode" id="cb167"><html><body><pre class="r"><span class="no">x20</span></pre></body></html></div>
<pre><code>##  [1] -1.20706575  0.27742924  1.08444118 -2.34569770  0.42912469  0.50605589
##  [7] -0.57473996 -0.54663186 -0.56445200 -0.89003783 -0.47719270 -0.99838644
## [13] -0.77625389  0.06445882  0.95949406 -0.11028549 -0.51100951 -0.91119542
## [19] -0.83717168  2.41583518</code></pre>
<div class="sourceCode" id="cb169"><html><body><pre class="r"><span class="no">x20os</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="no">x20</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="no">x20os</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">2</span>)</pre></body></html></div>
<pre><code>##  [1] 0.003760506 0.017709607 0.022793726 0.025256282 0.025886351 0.027518385
##  [7] 0.029504455 0.036938855 0.037356192 0.038088186 0.039586504 0.041052895
## [13] 0.059956038 0.071083274 0.086711761 0.099319695 0.106203872 0.153804251
## [19] 0.169087002 0.385111807</code></pre>
<div class="sourceCode" id="cb171"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="no">x20os</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">2</span>) - (<span class="fl">0</span>:(<span class="fl">20</span>-<span class="fl">1</span>))/<span class="no">n</span></pre></body></html></div>
<pre><code>##  [1]  0.003760506 -0.082290393 -0.177206274 -0.274743718 -0.374113649
##  [6] -0.472481615 -0.570495545 -0.663061145 -0.762643808 -0.861911814
## [11] -0.960413496 -1.058947105 -1.140043962 -1.228916726 -1.313288239
## [16] -1.400680305 -1.493796128 -1.546195749 -1.630912998 -1.514888193</code></pre>
<div class="sourceCode" id="cb173"><html><body><pre class="r"><span class="no">wrk1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="no">x20os</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">2</span>) - (<span class="fl">0</span>:(<span class="fl">20</span>-<span class="fl">1</span>))/<span class="fl">20</span>
<span class="no">wrk2</span> <span class="kw">&lt;-</span> (<span class="fl">1</span>:<span class="fl">20</span>)/<span class="fl">20</span> - <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="no">x20os</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">wrk1</span>,<span class="no">wrk2</span>)</pre></body></html></div>
<pre><code>## [1] 0.780913</code></pre>
<div class="sourceCode" id="cb175"><html><body><pre class="r"><span class="no">Dn.x20</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">wrk1</span>,<span class="no">wrk2</span>)
<span class="no">Dn.x20</span></pre></body></html></div>
<pre><code>## [1] 0.780913</code></pre>
<div class="sourceCode" id="cb177"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.Dn.html">psi.Dn</a></span>(<span class="no">x20</span>)</pre></body></html></div>
<pre><code>## [1] 0.2833875</code></pre>
<div class="sourceCode" id="cb179"><html><body><pre class="r"><span class="co"># ?psi.Dn</span>
<span class="fu"><a href="../reference/psi.Dn.html">psi.Dn</a></span>(<span class="no">x20</span>, <span class="kw">cdf</span><span class="kw">=</span><span class="no">pnorm</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">2</span>)</pre></body></html></div>
<pre><code>## [1] 0.780913</code></pre>
<div class="sourceCode" id="cb181"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">x20</span>, <span class="no">pnorm</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">2</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  x20
## D = 0.78091, p-value = 2.034e-13
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb183"><html><body><pre class="r"><span class="co"># ?psi.pks</span>
<span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="fl">0.5</span>, <span class="kw">n</span><span class="kw">=</span><span class="fl">20</span>)</pre></body></html></div>
<pre><code>## [1] 0.9999621</code></pre>
</div>
<div id="example-migraine" class="section level3">
<h3 class="hasAnchor">
<a href="#example-migraine" class="anchor"></a>Example migraine</h3>
<div class="sourceCode" id="cb185"><html><body><pre class="r"><span class="co">#</span>
<span class="co"># file.show("migraine.txt")</span>
<span class="no">datamig</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span>(<span class="st">"migraine.txt"</span>)
<span class="no">datamig</span></pre></body></html></div>
<pre><code>##  [1]  98  90 155  86  80  84  70 128  93  40 108  90 130  48  55 106 145 126 100
## [20] 115  75  95  38  66  63  32 105 118  21 142</code></pre>
<div class="sourceCode" id="cb187"><html><body><pre class="r"><span class="co">##  [1]  98  90 155  86  80  84  70 128  93  40 108  90 130  48  55 106 145</span>
<span class="co">## [18] 126 100 115  75  95  38  66  63  32 105 118  21 142</span>

<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">datamig</span>, <span class="no">pnorm</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">90</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">35</span>)</pre></body></html></div>
<pre><code>## Warning in ks.test(datamig, pnorm, mean = 90, sd = 35): ties should not be
## present for the Kolmogorov-Smirnov test</code></pre>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  datamig
## D = 0.066667, p-value = 0.9993
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb190"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">datamig</span>), <span class="no">pnorm</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">90</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">35</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  unique(datamig)
## D = 0.061367, p-value = 0.9996
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb192"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.Dn.html">psi.Dn</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">datamig</span>), <span class="no">pnorm</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">90</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">35</span>)</pre></body></html></div>
<pre><code>## [1] 0.06136731</code></pre>
<p>Example from help page of psi.pks</p>
<div class="sourceCode" id="cb194"><html><body><pre class="r"><span class="no">xi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>,<span class="fl">1</span>,<span class="kw">length</span><span class="kw">=</span><span class="fl">100</span>)            <span class="co"># some x values</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">xi</span>, <span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">xi</span>,<span class="fl">4</span>))               <span class="co"># cdf of D_4</span></pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-53-1.png" width="700"></p>
<p>diy Dn</p>
<div class="sourceCode" id="cb195"><html><body><pre class="r"><span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">datamig</span>)
<span class="no">x</span></pre></body></html></div>
<pre><code>##  [1]  98  90 155  86  80  84  70 128  93  40 108 130  48  55 106 145 126 100 115
## [20]  75  95  38  66  63  32 105 118  21 142</code></pre>
<div class="sourceCode" id="cb197"><html><body><pre class="r"><span class="no">xs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="no">x</span>)
<span class="no">xs</span></pre></body></html></div>
<pre><code>##  [1]  21  32  38  40  48  55  63  66  70  75  80  84  86  90  93  95  98 100 105
## [20] 106 108 115 118 126 128 130 142 145 155</code></pre>
<div class="sourceCode" id="cb199"><html><body><pre class="r"><span class="no">n</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">xs</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>( (<span class="fl">1</span>:<span class="no">n</span>)/<span class="no">n</span> - <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="no">xs</span>,<span class="kw">mean</span><span class="kw">=</span><span class="fl">90</span>,<span class="kw">sd</span><span class="kw">=</span><span class="fl">35</span>), <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="no">xs</span>,<span class="kw">mean</span><span class="kw">=</span><span class="fl">90</span>,<span class="kw">sd</span><span class="kw">=</span><span class="fl">35</span>) - (<span class="fl">0</span>:(<span class="no">n</span>-<span class="fl">1</span>))/<span class="no">n</span>)</pre></body></html></div>
<pre><code>## [1] 0.06136731</code></pre>
<p>Dn using psi.Dn</p>
<div class="sourceCode" id="cb201"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.Dn.html">psi.Dn</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">datamig</span>), <span class="no">pnorm</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">90</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">35</span>)</pre></body></html></div>
<pre><code>## [1] 0.06136731</code></pre>
<div class="sourceCode" id="cb203"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">datamig</span>),<span class="no">pnorm</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">90</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">35</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  unique(datamig)
## D = 0.061367, p-value = 0.9996
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb205"><html><body><pre class="r"><span class="no">migDn</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>( (<span class="fl">1</span>:<span class="no">n</span>)/<span class="no">n</span> - <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="no">xs</span>,<span class="kw">mean</span><span class="kw">=</span><span class="fl">90</span>,<span class="kw">sd</span><span class="kw">=</span><span class="fl">35</span>), <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="no">xs</span>,<span class="kw">mean</span><span class="kw">=</span><span class="fl">90</span>,<span class="kw">sd</span><span class="kw">=</span><span class="fl">35</span>) - (<span class="fl">0</span>:(<span class="no">n</span>-<span class="fl">1</span>))/<span class="no">n</span>)
<span class="no">migDn</span></pre></body></html></div>
<pre><code>## [1] 0.06136731</code></pre>
<div class="sourceCode" id="cb207"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">migDn</span>, <span class="no">n</span>)</pre></body></html></div>
<pre><code>## [1] 0.0004026694</code></pre>
<div class="sourceCode" id="cb209"><html><body><pre class="r"><span class="fl">1</span> - <span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">migDn</span>, <span class="no">n</span>)</pre></body></html></div>
<pre><code>## [1] 0.9995973</code></pre>
</div>
</div>
<div id="lilliefors-test-for-normality" class="section level2">
<h2 class="hasAnchor">
<a href="#lilliefors-test-for-normality" class="anchor"></a>Lilliefors test for normality</h2>
<div class="sourceCode" id="cb211"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/apropos.html">apropos</a></span>(<span class="st">"psi."</span>)
?<span class="no">psi.pkls.exp</span>
?<span class="no">psi.plks.exp</span>
?<span class="no">psi.qlks.exp</span></pre></body></html></div>
<p>This package provides lillie.test():</p>
<div class="sourceCode" id="cb212"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">nortest</span>)
<span class="co"># ?lillie.test</span>
<span class="fu"><a href="https://rdrr.io/pkg/nortest/man/lillie.test.html">lillie.test</a></span>(<span class="no">x20</span>)</pre></body></html></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  x20
## D = 0.1884, p-value = 0.06101</code></pre>
</div>
<div id="further-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#further-examples" class="anchor"></a>Further examples</h2>
<div id="example-moths" class="section level3">
<h3 class="hasAnchor">
<a href="#example-moths" class="anchor"></a>Example: moths</h3>
<div class="sourceCode" id="cb214"><html><body><pre class="r"><span class="co"># file.show("mothsontrees.txt")</span>
<span class="no">datamoths</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span>(<span class="st">"mothsontrees.txt"</span>)
<span class="no">datamoths</span></pre></body></html></div>
<pre><code>##  [1]  1.4  2.6  3.3  4.2  4.7  5.6  6.4  7.7  9.3 10.6 11.5 12.4 18.6 22.3</code></pre>
<div class="sourceCode" id="cb216"><html><body><pre class="r"><span class="co"># ?punif</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">datamoths</span>, <span class="no">punif</span>, <span class="kw">min</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">25</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  datamoths
## D = 0.36114, p-value = 0.03843
## alternative hypothesis: two-sided</code></pre>
<p>Alternatively:</p>
<div class="sourceCode" id="cb218"><html><body><pre class="r"><span class="no">mycdf</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">q</span>) <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">punif</a></span>(<span class="no">q</span>, <span class="kw">min</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">25</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">datamoths</span>, <span class="no">mycdf</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  datamoths
## D = 0.36114, p-value = 0.03843
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb220"><html><body><pre class="r"><span class="no">mothssorted</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="no">datamoths</span>)

<span class="no">val</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">punif</a></span>(<span class="no">mothssorted</span>, <span class="kw">min</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">25</span>)
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">datamoths</span>)</pre></body></html></div>
<pre><code>## [1] 14</code></pre>
<div class="sourceCode" id="cb222"><html><body><pre class="r"><span class="no">n</span> <span class="kw">&lt;-</span> <span class="fl">14</span>
(<span class="fl">1</span>:<span class="no">n</span>)/<span class="no">n</span></pre></body></html></div>
<pre><code>##  [1] 0.07142857 0.14285714 0.21428571 0.28571429 0.35714286 0.42857143
##  [7] 0.50000000 0.57142857 0.64285714 0.71428571 0.78571429 0.85714286
## [13] 0.92857143 1.00000000</code></pre>
<div class="sourceCode" id="cb224"><html><body><pre class="r">(<span class="fl">1</span>:<span class="no">n</span>)/<span class="no">n</span> - <span class="no">val</span></pre></body></html></div>
<pre><code>##  [1] 0.01542857 0.03885714 0.08228571 0.11771429 0.16914286 0.20457143
##  [7] 0.24400000 0.26342857 0.27085714 0.29028571 0.32571429 0.36114286
## [13] 0.18457143 0.10800000</code></pre>
<div class="sourceCode" id="cb226"><html><body><pre class="r"><span class="no">val</span> - (<span class="fl">0</span>:(<span class="no">n</span>-<span class="fl">1</span>))/<span class="no">n</span></pre></body></html></div>
<pre><code>##  [1]  0.05600000  0.03257143 -0.01085714 -0.04628571 -0.09771429 -0.13314286
##  [7] -0.17257143 -0.19200000 -0.19942857 -0.21885714 -0.25428571 -0.28971429
## [13] -0.11314286 -0.03657143</code></pre>
<div class="sourceCode" id="cb228"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>( (<span class="fl">1</span>:<span class="no">n</span>)/<span class="no">n</span> - <span class="no">val</span>, <span class="no">val</span> - (<span class="fl">0</span>:(<span class="no">n</span>-<span class="fl">1</span>))/<span class="no">n</span> )</pre></body></html></div>
<pre><code>## [1] 0.3611429</code></pre>
<div class="sourceCode" id="cb230"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">datamoths</span>, <span class="st">"punif"</span>, <span class="kw">min</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">25</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  datamoths
## D = 0.36114, p-value = 0.03843
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb232"><html><body><pre class="r"><span class="no">f1</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">x</span>,<span class="fl">14</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="no">f1</span>, <span class="kw">from</span><span class="kw">=</span><span class="fl">0.01</span>, <span class="fl">0.99</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-59-1.png" width="700"></p>
<div class="sourceCode" id="cb233"><html><body><pre class="r"><span class="no">xi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0.01</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">xi</span>, <span class="st">"f1(xi)"</span> <span class="kw">=</span> <span class="fu">f1</span>(<span class="no">xi</span>)))</pre></body></html></div>
<pre><code>##        xi       f1(xi)
## [1,] 0.00 0.000000e+00
## [2,] 0.01 0.000000e+00
## [3,] 0.02 0.000000e+00
## [4,] 0.03 0.000000e+00
## [5,] 0.04 1.007287e-18
## [6,] 0.05 2.105987e-11</code></pre>
<div class="sourceCode" id="cb235"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">datamoths</span>, <span class="st">"punif"</span>, <span class="kw">min</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">25</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  datamoths
## D = 0.36114, p-value = 0.03843
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb237"><html><body><pre class="r"><span class="no">d14</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>( (<span class="fl">1</span>:<span class="no">n</span>)/<span class="no">n</span> - <span class="no">val</span>, <span class="no">val</span> - (<span class="fl">0</span>:(<span class="no">n</span>-<span class="fl">1</span>))/<span class="no">n</span> )
<span class="no">d14</span></pre></body></html></div>
<pre><code>## [1] 0.3611429</code></pre>
<div class="sourceCode" id="cb239"><html><body><pre class="r"><span class="fl">1</span> - <span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">d14</span>,<span class="fl">14</span>)</pre></body></html></div>
<pre><code>## [1] 0.03842822</code></pre>
<div class="sourceCode" id="cb241"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">datamoths</span>, <span class="st">"punif"</span>, <span class="kw">min</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">25</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  datamoths
## D = 0.36114, p-value = 0.03843
## alternative hypothesis: two-sided</code></pre>
</div>
<div id="example-datasales" class="section level3">
<h3 class="hasAnchor">
<a href="#example-datasales" class="anchor"></a>Example: datasales</h3>
<div class="sourceCode" id="cb243"><html><body><pre class="r"><span class="no">datasales</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">8</span>,<span class="fl">18</span>,<span class="fl">9</span>,<span class="fl">11</span>,<span class="fl">13</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">datasales</span>, <span class="st">"pnorm"</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fl">10</span>, <span class="kw">sd</span><span class="kw">=</span><span class="fl">3</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  datasales
## D = 0.26296, p-value = 0.6278
## alternative hypothesis: two-sided</code></pre>
</div>
<div id="example-barbiturate" class="section level3">
<h3 class="hasAnchor">
<a href="#example-barbiturate" class="anchor"></a>Example: barbiturate</h3>
<div class="sourceCode" id="cb245"><html><body><pre class="r"><span class="co"># file.show("barbiturate.txt")</span>
<span class="no">databarbi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span>(<span class="st">"barbiturate.txt"</span>)
<span class="no">databarbi</span></pre></body></html></div>
<pre><code>##  [1] 2.70 2.20 2.80 0.90 0.30 4.30 6.20 1.25 0.90 0.60 3.00 1.60 3.20 4.10 0.79
## [16] 3.90 0.72 1.30 7.70 2.50 1.10 6.70 1.70 3.50 5.10 1.66 2.00 3.70 1.12 0.64
## [31] 2.80 6.10</code></pre>
<div class="sourceCode" id="cb247"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/lillie.test.html">lillie.test</a></span>(<span class="no">databarbi</span>)</pre></body></html></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  databarbi
## D = 0.13552, p-value = 0.1416</code></pre>
<div class="sourceCode" id="cb249"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">databarbi</span>,<span class="no">pnorm</span>,<span class="kw">mean</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">databarbi</span>), <span class="kw">sd</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">databarbi</span>))</pre></body></html></div>
<pre><code>## Warning in ks.test(databarbi, pnorm, mean = mean(databarbi), sd =
## sd(databarbi)): ties should not be present for the Kolmogorov-Smirnov test</code></pre>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  databarbi
## D = 0.13552, p-value = 0.5993
## alternative hypothesis: two-sided</code></pre>
</div>
<div id="example-bulbs1000" class="section level3">
<h3 class="hasAnchor">
<a href="#example-bulbs1000" class="anchor"></a>Example: bulbs1000</h3>
<div class="sourceCode" id="cb252"><html><body><pre class="r"><span class="no">databulbs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span>(<span class="st">"bulbs1000.txt"</span>)
<span class="no">databulbs</span></pre></body></html></div>
<pre><code>##  [1]  730 1648 1321  319  696   21  192  780 1659  167</code></pre>
<div class="sourceCode" id="cb254"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">databulbs</span>, <span class="st">"pexp"</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">2</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  databulbs
## D = 1, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb256"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">databulbs</span>, <span class="st">"pexp"</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">1</span>/<span class="fl">1000</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  databulbs
## D = 0.19033, p-value = 0.7978
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb258"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">databulbs</span>)</pre></body></html></div>
<pre><code>## [1] 753.3</code></pre>
<div class="sourceCode" id="cb260"><html><body><pre class="r"><span class="fl">1</span>/<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">databulbs</span>)</pre></body></html></div>
<pre><code>## [1] 0.001327492</code></pre>
<div class="sourceCode" id="cb262"><html><body><pre class="r"><span class="co"># apropos("psi.")</span>
<span class="co"># ?psi.lks.exp.test</span>
<span class="fu"><a href="../reference/psi.lks.exp.test.html">psi.lks.exp.test</a></span>(<span class="no">databulbs</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Lilliefors test for exponential distribution
## 
## data:  databulbs
## Dn.Lillie.exp = 0.20305, p-value = 0.525
## alternative hypothesis: two-sided</code></pre>
</div>
<div id="example-bulbs1500" class="section level3">
<h3 class="hasAnchor">
<a href="#example-bulbs1500" class="anchor"></a>Example: bulbs1500</h3>
<div class="sourceCode" id="cb264"><html><body><pre class="r"><span class="no">databulbs15</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span>(<span class="st">"bulbs1500.txt"</span>)
<span class="fu"><a href="../reference/psi.lks.exp.test.html">psi.lks.exp.test</a></span>(<span class="no">databulbs15</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Lilliefors test for exponential distribution
## 
## data:  databulbs15
## Dn.Lillie.exp = 0.25759, p-value = 0.207
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb266"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.lks.exp.test.html">psi.lks.exp.test</a></span>(<span class="no">databulbs15</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Lilliefors test for exponential distribution
## 
## data:  databulbs15
## Dn.Lillie.exp = 0.25759, p-value = 0.221
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb268"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.lks.exp.test.html">psi.lks.exp.test</a></span>(<span class="no">databulbs15</span>, <span class="kw">Nsim</span><span class="kw">=</span><span class="fl">10000</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Lilliefors test for exponential distribution
## 
## data:  databulbs15
## Dn.Lillie.exp = 0.25759, p-value = 0.2156
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb270"><html><body><pre class="r"><span class="co"># example: bulbs: is this the same as bulbs1000?</span>
<span class="co">#</span>
<span class="no">bulbs</span></pre></body></html></div>
<pre><code>##  [1] 1615.3880 1751.3540  951.2327 3727.3430 1333.2010  914.8320  507.4933
##  [8]  213.3106  862.1596 2217.3740</code></pre>
<div class="sourceCode" id="cb272"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">bulbs</span>)</pre></body></html></div>
<pre><code>## [1] 1409.369</code></pre>
<div class="sourceCode" id="cb274"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">bulbs</span>, <span class="no">pexp</span>, <span class="kw">rate</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">1500</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  bulbs
## D = 0.23717, p-value = 0.5504
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb276"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">bulbs</span>, <span class="no">pexp</span>, <span class="kw">rate</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">1000</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  bulbs
## D = 0.37775, p-value = 0.08623
## alternative hypothesis: two-sided</code></pre>
<p>Carry out Lilliefors test (simulation is used, so slight differences in repeated calculation)</p>
<div class="sourceCode" id="cb278"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.lks.exp.test.html">psi.lks.exp.test</a></span>(<span class="no">bulbs</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Lilliefors test for exponential distribution
## 
## data:  bulbs
## Dn.Lillie.exp = 0.25759, p-value = 0.221
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb280"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.lks.exp.test.html">psi.lks.exp.test</a></span>(<span class="no">bulbs</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Lilliefors test for exponential distribution
## 
## data:  bulbs
## Dn.Lillie.exp = 0.25759, p-value = 0.222
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb282"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.lks.exp.test.html">psi.lks.exp.test</a></span>(<span class="no">bulbs</span>, <span class="kw">Nsim</span> <span class="kw">=</span> <span class="fl">10000</span>)   <span class="co"># for more precision</span></pre></body></html></div>
<pre><code>## 
##  One-sample Lilliefors test for exponential distribution
## 
## data:  bulbs
## Dn.Lillie.exp = 0.25759, p-value = 0.2223
## alternative hypothesis: two-sided</code></pre>
<p>(semi-)diy (full diy would also calc. the Dn stat. by diy)</p>
<div class="sourceCode" id="cb284"><html><body><pre class="r"><span class="no">z</span> <span class="kw">&lt;-</span> <span class="no">bulbs</span>/<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">bulbs</span>)
<span class="no">zDn</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/psi.Dn.html">psi.Dn</a></span>(<span class="no">z</span>, <span class="no">pexp</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
<p>crit. value at alpha=0.05</p>
<div class="sourceCode" id="cb285"><html><body><pre class="r"><span class="no">DnN0p05</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/lilliefors.exp.html">psi.qlks.exp</a></span>(<span class="fl">1</span>-<span class="fl">0.05</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">z</span>))</pre></body></html></div>
<p>or, for more precision,</p>
<div class="sourceCode" id="cb286"><html><body><pre class="r"><span class="no">DnN0p05</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/lilliefors.exp.html">psi.qlks.exp</a></span>(<span class="fl">1</span>-<span class="fl">0.05</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">z</span>), <span class="kw">Nsim</span><span class="kw">=</span><span class="fl">10000</span>)

<span class="no">zDn</span> <span class="kw">&gt;</span> <span class="no">DnN0p05</span></pre></body></html></div>
<pre><code>##  0.95 
## FALSE</code></pre>
<div class="sourceCode" id="cb288"><html><body><pre class="r"><span class="co"># p-value</span>
<span class="fl">1</span> - <span class="fu"><a href="../reference/lilliefors.exp.html">psi.plks.exp</a></span>(<span class="no">zDn</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">z</span>), <span class="kw">Nsim</span><span class="kw">=</span><span class="fl">10000</span>)</pre></body></html></div>
<pre><code>## 0.257590782926558 
##            0.2234</code></pre>
</div>
<div id="example-oxboys-needs-clean-up" class="section level3">
<h3 class="hasAnchor">
<a href="#example-oxboys-needs-clean-up" class="anchor"></a>Example: Oxboys (needs clean-up)</h3>
<div class="sourceCode" id="cb290"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mlmRev</span>)</pre></body></html></div>
<pre><code>## Loading required package: lme4</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<div class="sourceCode" id="cb293"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">Oxboys</span>)          <span class="co"># Oxboys are from library(mlmRev)</span></pre></body></html></div>
<pre><code>##     Subject         age               height         Occasion 
##  1      :  9   Min.   :-1.00000   Min.   :126.2   1      :26  
##  10     :  9   1st Qu.:-0.46300   1st Qu.:143.8   2      :26  
##  11     :  9   Median :-0.00270   Median :149.5   3      :26  
##  12     :  9   Mean   : 0.02263   Mean   :149.5   4      :26  
##  13     :  9   3rd Qu.: 0.55620   3rd Qu.:155.5   5      :26  
##  14     :  9   Max.   : 1.00550   Max.   :174.8   6      :26  
##  (Other):180                                      (Other):78</code></pre>
<div class="sourceCode" id="cb295"><html><body><pre class="r"><span class="no">Oxboys</span>[<span class="fl">1</span>:<span class="fl">5</span>,]</pre></body></html></div>
<pre><code>##   Subject     age height Occasion
## 1       1 -1.0000  140.5        1
## 2       1 -0.7479  143.4        2
## 3       1 -0.4630  144.8        3
## 4       1 -0.1643  147.1        4
## 5       1 -0.0027  147.7        5</code></pre>
<div class="sourceCode" id="cb297"><html><body><pre class="r"><span class="no">Oxboys</span>[<span class="fl">1</span>:<span class="fl">5</span>, <span class="st">"height"</span>]</pre></body></html></div>
<pre><code>## [1] 140.5 143.4 144.8 147.1 147.7</code></pre>
<div class="sourceCode" id="cb299"><html><body><pre class="r"><span class="no">dataoxheight</span> <span class="kw">&lt;-</span> <span class="no">Oxboys</span>[,<span class="st">"height"</span>]
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">dataoxheight</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-68-1.png" width="700"></p>
<div class="sourceCode" id="cb300"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">dataoxheight</span>)</pre></body></html></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   126.2   143.8   149.5   149.5   155.5   174.8</code></pre>
<div class="sourceCode" id="cb302"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">dataoxheight</span>, <span class="kw">freq</span><span class="kw">=</span><span class="fl">FALSE</span>)  <span class="co"># todo: overlay exp pdf?</span></pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-68-2.png" width="700"></p>
<div class="sourceCode" id="cb303"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="no">dataoxheight</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-68-3.png" width="700"></p>
<div class="sourceCode" id="cb304"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span>(<span class="no">dataoxheight</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-68-4.png" width="700"></p>
<div class="sourceCode" id="cb305"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">nortest</span>)
<span class="fu"><a href="https://rdrr.io/pkg/nortest/man/lillie.test.html">lillie.test</a></span>(<span class="no">dataoxheight</span>)</pre></body></html></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  dataoxheight
## D = 0.042614, p-value = 0.378</code></pre>
<div class="sourceCode" id="cb307"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">dataoxheight</span>, <span class="no">pnorm</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">dataoxheight</span>), <span class="kw">sd</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">dataoxheight</span>)) <span class="co"># for comparison</span></pre></body></html></div>
<pre><code>## Warning in ks.test(dataoxheight, pnorm, mean = mean(dataoxheight), sd =
## sd(dataoxheight)): ties should not be present for the Kolmogorov-Smirnov test</code></pre>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  dataoxheight
## D = 0.042614, p-value = 0.7891
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb310"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">dataoxheight</span>), <span class="st">"pnorm"</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">dataoxheight</span>), <span class="kw">sd</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">dataoxheight</span>))</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  unique(dataoxheight)
## D = 0.043867, p-value = 0.8932
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb312"><html><body><pre class="r"><span class="co"># add some jitter to remove ties;  ?psi.jitter</span>
<span class="co"># ?psi.jitter</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="fu"><a href="../reference/psi.jitter.html">psi.jitter</a></span>(<span class="no">dataoxheight</span>,<span class="kw">amount</span><span class="kw">=</span><span class="fl">0.5</span>), <span class="no">pnorm</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">dataoxheight</span>), <span class="kw">sd</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">dataoxheight</span>))</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  psi.jitter(dataoxheight, amount = 0.5)
## D = 0.035408, p-value = 0.931
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb314"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="fu"><a href="../reference/psi.jitter.html">psi.jitter</a></span>(<span class="no">dataoxheight</span>,<span class="kw">amount</span><span class="kw">=</span><span class="fl">0.5</span>), <span class="no">pnorm</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">dataoxheight</span>), <span class="kw">sd</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">dataoxheight</span>))</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  psi.jitter(dataoxheight, amount = 0.5)
## D = 0.030803, p-value = 0.9795
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb316"><html><body><pre class="r"><span class="co">#?psi.Dn</span>
<span class="fu"><a href="../reference/psi.Dn.html">psi.Dn</a></span>(<span class="no">dataoxheight</span>, <span class="no">pnorm</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">dataoxheight</span>), <span class="kw">sd</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">dataoxheight</span>), <span class="kw">ties.jitter</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<pre><code>## [1] 0.04111807</code></pre>
<div class="sourceCode" id="cb318"><html><body><pre class="r"><span class="co"># ?psi.jitter</span>
<span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span>(<span class="no">dataoxheight</span>))</pre></body></html></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb320"><html><body><pre class="r"><span class="no">xj</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/psi.jitter.html">psi.jitter</a></span>(<span class="no">dataoxheight</span>, <span class="fl">0.5</span>)
<span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span>(<span class="no">xj</span>))</pre></body></html></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb322"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">xj</span>, <span class="st">"pnorm"</span>, <span class="kw">mean</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">dataoxheight</span>), <span class="kw">sd</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">dataoxheight</span>))</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  xj
## D = 0.045339, p-value = 0.7219
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb324"><html><body><pre class="r"><span class="co">###########################################</span>

<span class="no">datamig</span></pre></body></html></div>
<pre><code>##  [1]  98  90 155  86  80  84  70 128  93  40 108  90 130  48  55 106 145 126 100
## [20] 115  75  95  38  66  63  32 105 118  21 142</code></pre>
<div class="sourceCode" id="cb326"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>(<span class="kw">pattern</span><span class="kw">=</span><span class="st">"data*"</span>)</pre></body></html></div>
<pre><code>## [1] "databarbi"    "databulbs"    "databulbs15"  "datamig"      "datamoths"   
## [6] "dataoxheight" "datasales"</code></pre>
<div class="sourceCode" id="cb328"><html><body><pre class="r"><span class="no">databarbi</span></pre></body></html></div>
<pre><code>##  [1] 2.70 2.20 2.80 0.90 0.30 4.30 6.20 1.25 0.90 0.60 3.00 1.60 3.20 4.10 0.79
## [16] 3.90 0.72 1.30 7.70 2.50 1.10 6.70 1.70 3.50 5.10 1.66 2.00 3.70 1.12 0.64
## [31] 2.80 6.10</code></pre>
<div class="sourceCode" id="cb330"><html><body><pre class="r"><span class="no">databulbs</span></pre></body></html></div>
<pre><code>##  [1]  730 1648 1321  319  696   21  192  780 1659  167</code></pre>
</div>
<div id="example-checking-normality-of-residuals-from-lm" class="section level3">
<h3 class="hasAnchor">
<a href="#example-checking-normality-of-residuals-from-lm" class="anchor"></a>Example: checking normality of residuals from lm()</h3>
<div class="sourceCode" id="cb332"><html><body><pre class="r"><span class="no">datamilk</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
     <span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">42.7</span>,<span class="fl">40.2</span>,<span class="fl">38.2</span>,<span class="fl">37.6</span>,<span class="fl">32.2</span>,<span class="fl">32.2</span>,<span class="fl">28</span>,<span class="fl">27.2</span>,<span class="fl">26.6</span>,<span class="fl">23</span>,<span class="fl">22.7</span>,<span class="fl">21.8</span>,<span class="fl">21.3</span>,<span class="fl">20.2</span>),
     <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.2</span>,<span class="fl">1.16</span>,<span class="fl">1.07</span>,<span class="fl">1.13</span>,<span class="fl">0.96</span>,<span class="fl">1.07</span>,<span class="fl">0.85</span>,<span class="fl">0.87</span>,<span class="fl">0.77</span>,<span class="fl">0.74</span>,<span class="fl">0.76</span>,<span class="fl">0.69</span>,<span class="fl">0.72</span>,<span class="fl">0.64</span>)
   )
<span class="no">fitmilk</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">y</span>~<span class="no">x</span>, <span class="kw">data</span><span class="kw">=</span><span class="no">datamilk</span>)
<span class="no">datamilk</span></pre></body></html></div>
<pre><code>##       x    y
## 1  42.7 1.20
## 2  40.2 1.16
## 3  38.2 1.07
## 4  37.6 1.13
## 5  32.2 0.96
## 6  32.2 1.07
## 7  28.0 0.85
## 8  27.2 0.87
## 9  26.6 0.77
## 10 23.0 0.74
## 11 22.7 0.76
## 12 21.8 0.69
## 13 21.3 0.72
## 14 20.2 0.64</code></pre>
<div class="sourceCode" id="cb334"><html><body><pre class="r"><span class="no">fitmilk</span></pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = datamilk)
## 
## Coefficients:
## (Intercept)            x  
##     0.17558      0.02458</code></pre>
<div class="sourceCode" id="cb336"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">fitmilk</span>)</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = datamilk)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.059293 -0.024055 -0.005221  0.024711  0.103082 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.175576   0.046399   3.784   0.0026 ** 
## x           0.024576   0.001523  16.139 1.68e-09 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.04203 on 12 degrees of freedom
## Multiple R-squared:  0.956,  Adjusted R-squared:  0.9523 
## F-statistic: 260.5 on 1 and 12 DF,  p-value: 1.678e-09</code></pre>
<div class="sourceCode" id="cb338"><html><body><pre class="r"><span class="co"># plot(fitmilk)</span>
<span class="no">resfitmilk</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span>(<span class="no">fitmilk</span>)
<span class="fu"><a href="https://rdrr.io/pkg/nortest/man/lillie.test.html">lillie.test</a></span>(<span class="no">resfitmilk</span>)</pre></body></html></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  resfitmilk
## D = 0.15457, p-value = 0.4848</code></pre>
<p>todo: also qq-plot? ## Lilliefors test for exponentiality</p>
<div class="sourceCode" id="cb340"><html><body><pre class="r">?<span class="no">psi.plks</span>
?<span class="no">psi.plks.exp</span>
?<span class="no">psi.lks.exp.test</span>
?<span class="no">psi.Dn</span>
?<span class="no">psi.pks</span></pre></body></html></div>
<div class="sourceCode" id="cb341"><html><body><pre class="r"><span class="no">databulbs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span>(<span class="st">"bulbs1000.txt"</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">databulbs</span>, <span class="st">"pexp"</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">2</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  databulbs
## D = 1, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb343"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">databulbs</span>)</pre></body></html></div>
<pre><code>## [1] 753.3</code></pre>
<div class="sourceCode" id="cb345"><html><body><pre class="r"><span class="fl">1</span>/<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">databulbs</span>)</pre></body></html></div>
<pre><code>## [1] 0.001327492</code></pre>
<div class="sourceCode" id="cb347"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">databulbs</span>, <span class="st">"pexp"</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">1</span>/<span class="fl">1000</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  databulbs
## D = 0.19033, p-value = 0.7978
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb349"><html><body><pre class="r"><span class="fu"><a href="../reference/lilliefors.exp.html">psi.plks.exp</a></span>(<span class="fl">0.203</span>, <span class="kw">df</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">databulbs</span>))</pre></body></html></div>
<pre><code>## 0.203 
##  0.49</code></pre>
<div class="sourceCode" id="cb351"><html><body><pre class="r"><span class="fl">1</span> - <span class="fu"><a href="../reference/lilliefors.exp.html">psi.plks.exp</a></span>(<span class="fl">0.203</span>, <span class="kw">df</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">databulbs</span>))</pre></body></html></div>
<pre><code>## 0.203 
## 0.549</code></pre>
<div class="sourceCode" id="cb353"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="no">x</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">databulbs</span>)), <span class="kw">from</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">to</span><span class="kw">=</span><span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span>(<span class="fu"><a href="../reference/lilliefors.exp.html">psi.plks.exp</a></span>(<span class="no">x</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">databulbs</span>)), <span class="kw">from</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">to</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"blue"</span>, <span class="kw">add</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">h</span><span class="kw">=</span><span class="fl">0.95</span>)</pre></body></html></div>
<p><img src="ks.spin_files/figure-html/unnamed-chunk-71-1.png" width="700"></p>
<div class="sourceCode" id="cb354"><html><body><pre class="r"><span class="co"># ?names</span>
<span class="co"># ?c</span>
<span class="no">databulbs</span></pre></body></html></div>
<pre><code>##  [1]  730 1648 1321  319  696   21  192  780 1659  167</code></pre>
<div class="sourceCode" id="cb356"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span>(<span class="no">databulbs</span>, <span class="st">"pexp"</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">1</span>/<span class="fl">1000</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  databulbs
## D = 0.19033, p-value = 0.7978
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb358"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.Dn.html">psi.Dn</a></span>(<span class="no">databulbs</span>, <span class="st">"pexp"</span>, <span class="kw">rate</span><span class="kw">=</span><span class="fl">1</span>/<span class="fl">1000</span>)</pre></body></html></div>
<pre><code>## [1] 0.1903292</code></pre>
<p>q : P(Dn &lt; q) = 0.95 for selected values of n</p>
<div class="sourceCode" id="cb360"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="fl">0.6239385</span>,     <span class="fl">4</span>)</pre></body></html></div>
<pre><code>## [1] 0.95</code></pre>
<div class="sourceCode" id="cb362"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="fl">0.2940753</span>,    <span class="fl">20</span>)</pre></body></html></div>
<pre><code>## [1] 0.95</code></pre>
<div class="sourceCode" id="cb364"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="fl">0.1340279</span>,   <span class="fl">100</span>)</pre></body></html></div>
<pre><code>## [1] 0.95</code></pre>
<div class="sourceCode" id="cb366"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.pks.html">psi.pks</a></span>(<span class="fl">0.04294685</span>, <span class="fl">1000</span>)   <span class="co"># asymptotic approximation</span></pre></body></html></div>
<pre><code>## [1] 0.95</code></pre>
<div class="sourceCode" id="cb368"><html><body><pre class="r"><span class="no">databulbs</span></pre></body></html></div>
<pre><code>##  [1]  730 1648 1321  319  696   21  192  780 1659  167</code></pre>
<div class="sourceCode" id="cb370"><html><body><pre class="r"><span class="fu"><a href="../reference/psi.lks.exp.test.html">psi.lks.exp.test</a></span>(<span class="no">databulbs</span>)</pre></body></html></div>
<pre><code>## 
##  One-sample Lilliefors test for exponential distribution
## 
## data:  databulbs
## Dn.Lillie.exp = 0.20305, p-value = 0.533
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb372"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">databulbs</span>)</pre></body></html></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb374"><html><body><pre class="r"><span class="fu"><a href="../reference/lilliefors.exp.html">psi.plks.exp</a></span>(<span class="fl">0.203</span>, <span class="kw">df</span><span class="kw">=</span><span class="fl">10</span>)</pre></body></html></div>
<pre><code>## 0.203 
## 0.478</code></pre>
<div class="sourceCode" id="cb376"><html><body><pre class="r"><span class="fl">1</span> - <span class="fu"><a href="../reference/lilliefors.exp.html">psi.plks.exp</a></span>(<span class="fl">0.203</span>, <span class="kw">df</span><span class="kw">=</span><span class="fl">10</span>)</pre></body></html></div>
<pre><code>## 0.203 
##  0.54</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Georgi N. Boshnakov.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
